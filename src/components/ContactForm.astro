---
const formAction = "/api/contact";
---

<form class="contact-form" name="contact" method="POST" action={formAction} id="contact-form">
	<input type="hidden" name="form-name" value="contact" />
	
	<div id="form-message" class="form-message" style="display: none;"></div>
	
	<div class="form-group">
		<label for="name">Name *</label>
		<input type="text" id="name" name="name" required />
	</div>

	<div class="form-group">
		<label for="email">Email *</label>
		<input type="email" id="email" name="email" required />
	</div>

	<div class="form-group">
		<label for="company">Company</label>
		<input type="text" id="company" name="company" />
	</div>

	<div class="form-group">
		<label for="subject">Subject *</label>
		<input type="text" id="subject" name="subject" required />
	</div>

	<div class="form-group">
		<label for="message">Message *</label>
		<textarea id="message" name="message" rows="6" required></textarea>
	</div>

	<button type="submit" class="btn btn-primary" id="submit-btn">Send Message</button>
</form>

<script>
	const form = document.getElementById('contact-form');
	const messageDiv = document.getElementById('form-message');
	const submitBtn = document.getElementById('submit-btn');

	form?.addEventListener('submit', async (e) => {
		e.preventDefault();
		
		// Disable submit button
		if (submitBtn) {
			submitBtn.disabled = true;
			submitBtn.textContent = 'Sending...';
		}

		// Hide previous messages
		if (messageDiv) {
			messageDiv.style.display = 'none';
		}

		const formData = new FormData(form);

		try {
			const response = await fetch(formAction, {
				method: 'POST',
				body: formData
			});

			const data = await response.json();

			if (messageDiv) {
				messageDiv.textContent = data.message;
				messageDiv.className = 'form-message ' + (data.success ? 'success' : 'error');
				messageDiv.style.display = 'block';
			}

			if (data.success) {
				form.reset();
			}
		} catch (error) {
			if (messageDiv) {
				messageDiv.textContent = 'There was an error submitting your form. Please try again.';
				messageDiv.className = 'form-message error';
				messageDiv.style.display = 'block';
			}
		} finally {
			// Re-enable submit button
			if (submitBtn) {
				submitBtn.disabled = false;
				submitBtn.textContent = 'Send Message';
			}
		}
	});
</script>

<style>
	.contact-form {
		max-width: 600px;
		margin: 0 auto;
	}

	.form-group {
		margin-bottom: 1.5rem;
	}

	.form-group label {
		display: block;
		margin-bottom: 0.5rem;
		color: var(--color-text);
		font-weight: 500;
	}

	.form-group input,
	.form-group textarea {
		width: 100%;
		padding: 0.875rem;
		border: 2px solid #e0e0e0;
		border-radius: 5px;
		font-size: 1rem;
		font-family: inherit;
		transition: border-color 0.3s ease;
	}

	.form-group input:focus,
	.form-group textarea:focus {
		outline: none;
		border-color: var(--color-orange);
	}

	.form-group textarea {
		resize: vertical;
	}

	.hidden {
		display: none;
	}

	.btn {
		width: 100%;
		padding: 1rem;
		font-size: 1rem;
	}

	.btn:disabled {
		opacity: 0.6;
		cursor: not-allowed;
	}

	.form-message {
		padding: 1rem;
		border-radius: 5px;
		margin-bottom: 1.5rem;
		font-weight: 500;
	}

	.form-message.success {
		background-color: #d4edda;
		color: #155724;
		border: 1px solid #c3e6cb;
	}

	.form-message.error {
		background-color: #f8d7da;
		color: #721c24;
		border: 1px solid #f5c6cb;
	}
</style>

